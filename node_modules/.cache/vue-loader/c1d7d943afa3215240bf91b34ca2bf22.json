{"remainingRequest":"/Users/huangweiji/Desktop/code/git_project/-Dragon-Boat-Festival/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/huangweiji/Desktop/code/git_project/-Dragon-Boat-Festival/src/components/common/Affix/Affix.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/huangweiji/Desktop/code/git_project/-Dragon-Boat-Festival/src/components/common/Affix/Affix.vue","mtime":1624322764000},{"path":"/Users/huangweiji/Desktop/code/git_project/-Dragon-Boat-Festival/node_modules/cache-loader/dist/cjs.js","mtime":1639105455449},{"path":"/Users/huangweiji/Desktop/code/git_project/-Dragon-Boat-Festival/node_modules/babel-loader/lib/index.js","mtime":1639105455772},{"path":"/Users/huangweiji/Desktop/code/git_project/-Dragon-Boat-Festival/node_modules/cache-loader/dist/cjs.js","mtime":1639105455449},{"path":"/Users/huangweiji/Desktop/code/git_project/-Dragon-Boat-Festival/node_modules/vue-loader/lib/index.js","mtime":1639105455859}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KCi8qKgogKiDlm7rpkokKICovCmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogewogICAgb2Zmc2V0OiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogMCwKICAgIH0sCiAgICBvbkFmZml4OiB7CiAgICAgIHR5cGU6IEZ1bmN0aW9uLAogICAgICBkZWZhdWx0KCkge30sCiAgICB9LAogICAgYm91bmRhcnk6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAiIiwKICAgIH0sCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYWZmaXhlZDogZmFsc2UsCiAgICAgIHN0eWxlczoge30sCiAgICAgIGFmZml4ZWRDbGllbnRIZWlnaHQ6IDAsCiAgICAgIHdyYXBTdHlsZToge30sCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0U2Nyb2xsKHcsIHRvcCkgewogICAgICBsZXQgcmV0ID0gd1tgcGFnZSR7dG9wID8gIlkiIDogIlgifU9mZnNldGBdOwogICAgICBjb25zdCBtZXRob2QgPSBgc2Nyb2xsJHt0b3AgPyAiVG9wIiA6ICJMZWZ0In1gOwogICAgICBpZiAodHlwZW9mIHJldCAhPT0gIm51bWJlciIpIHsKICAgICAgICBjb25zdCBkID0gdy5kb2N1bWVudDsKICAgICAgICAvLyBpZTYsNyw4IAogICAgICAgIHJldCA9IGQuZG9jdW1lbnRFbGVtZW50W21ldGhvZF07CiAgICAgICAgaWYgKHR5cGVvZiByZXQgIT09ICJudW1iZXIiKSB7CiAgICAgICAgICByZXQgPSBkLmJvZHlbbWV0aG9kXTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJldDsKICAgIH0sCiAgICBnZXRPZmZzZXQoZWxlbWVudCkgewogICAgICBjb25zdCByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgY29uc3QgYm9keSA9IGRvY3VtZW50LmJvZHk7CiAgICAgIGNvbnN0IGNsaWVudFRvcCA9IGVsZW1lbnQuY2xpZW50VG9wIHx8IGJvZHkuY2xpZW50VG9wIHx8IDA7CiAgICAgIGNvbnN0IGNsaWVudExlZnQgPSBlbGVtZW50LmNsaWVudExlZnQgfHwgYm9keS5jbGllbnRMZWZ0IHx8IDA7CiAgICAgIC8vIGNvbnN0IGNsaWVudEhlaWdodCA9IGVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IDA7CiAgICAgIGNvbnN0IHNjcm9sbFRvcCA9IHRoaXMuZ2V0U2Nyb2xsKHdpbmRvdywgdHJ1ZSk7CiAgICAgIGNvbnN0IHNjcm9sbExlZnQgPSB0aGlzLmdldFNjcm9sbCh3aW5kb3cpOwogICAgICByZXR1cm4gewogICAgICAgIHRvcDogcmVjdC5ib3R0b20gKyBzY3JvbGxUb3AgLSBjbGllbnRUb3AgLSB0aGlzLmFmZml4ZWRDbGllbnRIZWlnaHQsCiAgICAgICAgbGVmdDogcmVjdC5sZWZ0ICsgc2Nyb2xsTGVmdCAtIGNsaWVudExlZnQsCiAgICAgIH07CiAgICB9LAogICAgaGFuZGxlU2Nyb2xsKCkgewogICAgICBjb25zdCBzY3JvbGxUb3AgPSB0aGlzLmdldFNjcm9sbCh3aW5kb3csIHRydWUpICsgdGhpcy5vZmZzZXRzOyAKICAgICAgY29uc3QgZWxlbWVudE9mZnNldCA9IHRoaXMuZ2V0T2Zmc2V0KHRoaXMuJGVsKTsKICAgICAgaWYgKCF0aGlzLmFmZml4ZWQgJiYgc2Nyb2xsVG9wID4gZWxlbWVudE9mZnNldC50b3ApIHsKICAgICAgICB0aGlzLmFmZml4ZWQgPSB0cnVlOwogICAgICAgIHRoaXMuc3R5bGVzID0gewogICAgICAgICAgdG9wOiBgJHt0aGlzLm9mZnNldHN9cHhgLAogICAgICAgICAgbGVmdDogYCR7ZWxlbWVudE9mZnNldC5sZWZ0fXB4YCwKICAgICAgICB9OwogICAgICAgIHRoaXMub25BZmZpeCh0aGlzLmFmZml4ZWQpOwogICAgICB9CiAgICAgIC8vIAogICAgICBpZiAodGhpcy5ib3VuZGFyeSAmJiBzY3JvbGxUb3AgPiBlbGVtZW50T2Zmc2V0LnRvcCkgewogICAgICAgIGNvbnN0IGVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5ib3VuZGFyeS5zbGljZSgxKSk7CiAgICAgICAgaWYgKGVsKSB7CiAgICAgICAgICBjb25zdCBib3VuZGFyeU9mZnNldCA9IHRoaXMuZ2V0T2Zmc2V0KGVsKTsKICAgICAgICAgIGlmIChzY3JvbGxUb3AgKyB0aGlzLm9mZnNldHMgPiBib3VuZGFyeU9mZnNldC50b3ApIHsKICAgICAgICAgICAgY29uc3QgdG9wID0gc2Nyb2xsVG9wIC0gYm91bmRhcnlPZmZzZXQudG9wOwogICAgICAgICAgICB0aGlzLnN0eWxlcy50b3AgPSBgLSR7dG9wfXB4YDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHRoaXMuYWZmaXhlZCAmJiBzY3JvbGxUb3AgPCBlbGVtZW50T2Zmc2V0LnRvcCkgewogICAgICAgIHRoaXMuYWZmaXhlZCA9IGZhbHNlOwogICAgICAgIHRoaXMuc3R5bGVzID0ge307CiAgICAgICAgdGhpcy5vbkFmZml4KHRoaXMuYWZmaXhlZCk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuYWZmaXhlZCAmJiB0aGlzLmJvdW5kYXJ5KSB7CiAgICAgICAgY29uc3QgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLmJvdW5kYXJ5LnNsaWNlKDEpKTsKICAgICAgICBpZiAoZWwpIHsKICAgICAgICAgIGNvbnN0IGJvdW5kYXJ5T2Zmc2V0ID0gdGhpcy5nZXRPZmZzZXQoZWwpOwogICAgICAgICAgaWYgKHNjcm9sbFRvcCArIHRoaXMub2Zmc2V0cyA8PSBib3VuZGFyeU9mZnNldC50b3ApIHsKICAgICAgICAgICAgdGhpcy5zdHlsZXMudG9wID0gMDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgfSwKICBjb21wdXRlZDogewogICAgb2Zmc2V0cygpIHsKICAgICAgaWYgKHRoaXMuYm91bmRhcnkpIHsKICAgICAgICByZXR1cm4gMDsKICAgICAgfQogICAgICByZXR1cm4gdGhpcy5vZmZzZXQ7CiAgICB9LAogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuYWZmaXhlZENsaWVudEhlaWdodCA9IHRoaXMuJGVsLmNoaWxkcmVuWzBdLmNsaWVudEhlaWdodDsKICAgIHRoaXMud3JhcFN0eWxlID0geyBoZWlnaHQ6IGAke3RoaXMuYWZmaXhlZENsaWVudEhlaWdodH1weGAgfTsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJzY3JvbGwiLCB0aGlzLmhhbmRsZVNjcm9sbCk7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgdGhpcy5oYW5kbGVTY3JvbGwpOwogIH0sCiAgYmVmb3JlRGVzdHJveSgpIHsKICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCJzY3JvbGwiLCB0aGlzLmhhbmRsZVNjcm9sbCk7CiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigicmVzaXplIiwgdGhpcy5oYW5kbGVTY3JvbGwpOwogIH0sCn07Cg=="},{"version":3,"sources":["Affix.vue"],"names":[],"mappings":";;;;;;;;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Affix.vue","sourceRoot":"src/components/common/Affix","sourcesContent":["<template>\n  <div class=\"affix-placeholder\" :style=\"wrapStyle\">\n    <div :class=\"{ affix: affixed }\" :style=\"styles\">\n      <slot></slot>\n    </div>\n  </div>\n</template>\n<script>\n/**\n * 固钉\n */\nexport default {\n  props: {\n    offset: {\n      type: Number,\n      default: 0,\n    },\n    onAffix: {\n      type: Function,\n      default() {},\n    },\n    boundary: {\n      type: String,\n      default: \"\",\n    },\n  },\n  data() {\n    return {\n      affixed: false,\n      styles: {},\n      affixedClientHeight: 0,\n      wrapStyle: {},\n    };\n  },\n  methods: {\n    getScroll(w, top) {\n      let ret = w[`page${top ? \"Y\" : \"X\"}Offset`];\n      const method = `scroll${top ? \"Top\" : \"Left\"}`;\n      if (typeof ret !== \"number\") {\n        const d = w.document;\n        // ie6,7,8 \n        ret = d.documentElement[method];\n        if (typeof ret !== \"number\") {\n          ret = d.body[method];\n        }\n      }\n      return ret;\n    },\n    getOffset(element) {\n      const rect = element.getBoundingClientRect();\n      const body = document.body;\n      const clientTop = element.clientTop || body.clientTop || 0;\n      const clientLeft = element.clientLeft || body.clientLeft || 0;\n      // const clientHeight = element.clientHeight || 0;\n      const scrollTop = this.getScroll(window, true);\n      const scrollLeft = this.getScroll(window);\n      return {\n        top: rect.bottom + scrollTop - clientTop - this.affixedClientHeight,\n        left: rect.left + scrollLeft - clientLeft,\n      };\n    },\n    handleScroll() {\n      const scrollTop = this.getScroll(window, true) + this.offsets; \n      const elementOffset = this.getOffset(this.$el);\n      if (!this.affixed && scrollTop > elementOffset.top) {\n        this.affixed = true;\n        this.styles = {\n          top: `${this.offsets}px`,\n          left: `${elementOffset.left}px`,\n        };\n        this.onAffix(this.affixed);\n      }\n      // \n      if (this.boundary && scrollTop > elementOffset.top) {\n        const el = document.getElementById(this.boundary.slice(1));\n        if (el) {\n          const boundaryOffset = this.getOffset(el);\n          if (scrollTop + this.offsets > boundaryOffset.top) {\n            const top = scrollTop - boundaryOffset.top;\n            this.styles.top = `-${top}px`;\n          }\n        }\n      }\n      if (this.affixed && scrollTop < elementOffset.top) {\n        this.affixed = false;\n        this.styles = {};\n        this.onAffix(this.affixed);\n      }\n      if (this.affixed && this.boundary) {\n        const el = document.getElementById(this.boundary.slice(1));\n        if (el) {\n          const boundaryOffset = this.getOffset(el);\n          if (scrollTop + this.offsets <= boundaryOffset.top) {\n            this.styles.top = 0;\n          }\n        }\n      }\n    },\n  },\n  computed: {\n    offsets() {\n      if (this.boundary) {\n        return 0;\n      }\n      return this.offset;\n    },\n  },\n  mounted() {\n    this.affixedClientHeight = this.$el.children[0].clientHeight;\n    this.wrapStyle = { height: `${this.affixedClientHeight}px` };\n    window.addEventListener(\"scroll\", this.handleScroll);\n    window.addEventListener(\"resize\", this.handleScroll);\n  },\n  beforeDestroy() {\n    window.removeEventListener(\"scroll\", this.handleScroll);\n    window.removeEventListener(\"resize\", this.handleScroll);\n  },\n};\n</script>\n<style scoped>\n.affix {\n  position: fixed;\n  z-index: 999;\n  width: 100vw;\n}\n</style>"]}]}